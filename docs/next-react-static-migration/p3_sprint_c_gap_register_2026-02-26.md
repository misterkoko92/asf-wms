# P3 Sprint C - Registre des ecarts de parite fonctionnelle (2026-02-26)

## Objectif

Tracer explicitement tous les ecarts fonctionnels restants de la matrice (`scan` + `portal` + routes dynamiques) pour piloter la fermeture vers un `DONE` global.

## Regles de fermeture

- Un item ne passe a `DONE` qu avec equivalence metier validee (actions, validations, permissions, transitions).
- Chaque fermeture exige couverture de tests (API + UI navigateur) et trace dans la recette manuelle.
- Les ecarts visuels ne bloquent pas la fermeture fonctionnelle, mais restent documentes.

## Registre global

| Priorite | Legacy | Next | Statut | Gap fonctionnel principal | Tests manquants | Owner | Increment cible | Critere de fermeture |
|---|---|---|---|---|---|---|---|---|
| P1 | `/scan/dashboard/` | `/app/scan/dashboard/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/stock/` | `/app/scan/stock/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/stock-update/` | `/app/scan/stock/` (zone MAJ inline cible) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/out/` | `/app/scan/stock/` (zone sortie cible) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/shipment/` | `/app/scan/shipment-create/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/shipments-tracking/` | `/app/scan/shipments-tracking/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/shipment/<id>/close` (logique legacy) | `/app/scan/shipments-tracking/` (integration transitoire) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/pack/` | `/app/scan/shipment-create/` (integration transitoire) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/cartons/` | `/app/scan/cartons/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/scan/shipments-ready/` | `/app/scan/shipments-ready/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/scan/orders-view/` | `/app/scan/orders/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/orders/` | `/app/scan/order/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/receipts/` | `/app/scan/receipts/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/receive/` | `/app/scan/receive/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/receive-pallet/` | `/app/scan/receive-pallet/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/receive-association/` | `/app/scan/receive-association/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/settings/` | `/app/scan/settings/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/faq/` | `/app/scan/faq/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P3 | `/scan/import/` | `/app/scan/import/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 3 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/shipment/<id>/documents/upload/` | `/app/scan/shipment-documents/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/scan/shipment/<id>/documents/<id>/delete/` | `/app/scan/shipment-documents/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/scan/shipment/<id>/labels/` | `/app/scan/shipment-documents/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/scan/shipment/<id>/labels/<carton_id>/` | `/app/scan/shipment-documents/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P3 | `/scan/templates/` | `/app/scan/templates/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 3 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P3 | `/scan/templates/<doc_type>/` | `/app/scan/templates/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 3 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/portal/` | `/app/portal/dashboard/` | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/portal/orders/new/` | `/app/portal/dashboard/` (integration transitoire) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 1 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P1 | `/portal/orders/<id>/` | `/app/portal/orders/detail/?id=<id>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 1 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/portal/recipients/` | `/app/portal/dashboard/` (integration transitoire) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/portal/account/` | `/app/portal/dashboard/` (integration transitoire) | IN_PROGRESS | Completer les regles metier/validations manquantes et lever les integrations transitoires. | Etendre tests API + NextUiTests sur cas limites, transitions et erreurs metier. | Next+API | Sprint C - Vague 2 | Equivalence metier validee + tests verts + recette manuelle signee. |
| P2 | `/portal/change-password/` | `/app/portal/change-password/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/portal/login/` | `/app/portal/login/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/portal/logout/` | `/app/portal/logout/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P3 | `/portal/request-account/` | `/app/portal/request-account/` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 3 | Route creee et validee de bout en bout sans ecart metier. |
| P3 | `/portal/set-password/<uid>/<token>/` | `/app/portal/set-password/?...` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 3 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/shipment/<id>/edit/` | `/app/scan/shipment/edit/?id=<id>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/shipment/track/<token>/` | `/app/scan/shipment/track/?token=<token>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/shipment/track/<ref>/` | `/app/scan/shipment/track/?ref=<ref>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/carton/<id>/doc/` | `/app/scan/carton/doc/?id=<id>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |
| P2 | `/scan/carton/<id>/picking/` | `/app/scan/carton/picking/?id=<id>` | TODO | Implementer route Next + branchement API/permissions + comportement legacy equivalent. | Ajouter tests endpoints, role-matrix et scenario navigateur associe. | Next+API | Sprint C - Vague 2 | Route creee et validee de bout en bout sans ecart metier. |

## Pilotage quotidien

- Mettre a jour chaque ligne avec un lien vers PR/commit de fermeture.
- Reclasser la priorite si un blocage terrain apparait.
- Synchroniser ce registre avec la matrice de parite a chaque increment.
